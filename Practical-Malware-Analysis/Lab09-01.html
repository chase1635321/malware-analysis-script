
    <!DOCTYPE HTML>
<html>
	<head>
		<title>Chase Kanipe</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="../assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body>
		<!-- Header -->
			<div id="header" class="alt">
				<a class="logo" href="../index.html"><strong>Chase</strong> Kanipe</a>
			</div>

		<!-- Main -->
			<div id="main">

				<!-- Header -->
					<header>
						<h1>pma9-1 Analysis</h1>
					</header>

				<!-- Content -->
					<section id="content" class="wrapper">
<p>
<h2 id="executive-summary">Executive Summary</h2>
<h3 id="installation">Installation</h3>
<p>This malware can be run as a standalone executable.</p>
<h3 id="behavior">Behavior</h3>
<p>This malware takes several commands from a command control server, which can include SLEEP, UPLOAD, DOWNLOAD, CMD, or NOTHING. It then performs these actions.</p>
<h3 id="persistence">Persistence</h3>
<p>This malware persists by installing itself as a service.</p>
<h3 id="removal">Removal</h3>
<p>This malware can be removed by running it with the -re flag or uninstalling the service.</p>
<hr />
<h3 id="file-information">File Information</h3>
<table>
<thead>
<tr class="header">
<th>Field</th>
<th>Data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Filename</td>
<td>/home/chase/github/malware-reports/scripts/Lab09-01.exe</td>
</tr>
<tr class="even">
<td>File Size</td>
<td>61440 bytes</td>
</tr>
<tr class="odd">
<td>MD5</td>
<td>b94af4a4d4af6eac81fc135abda1c40c</td>
</tr>
<tr class="even">
<td>SHA1</td>
<td>d6356b2c6f8d29f8626062b5aefb13b7fc744d54</td>
</tr>
<tr class="odd">
<td>SHA256</td>
<td>6ac06dfa543dca43327d55a61d0aaed25f3c90cce791e0555e3e306d47107859</td>
</tr>
<tr class="even">
<td>Architecture</td>
<td>x86</td>
</tr>
<tr class="odd">
<td>Compiler</td>
<td></td>
</tr>
<tr class="even">
<td>Statically linked</td>
<td>False</td>
</tr>
<tr class="odd">
<td>Stripped</td>
<td>False</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="strings">Strings</h3>
<table>
<thead>
<tr class="header">
<th>Address</th>
<th>String</th>
<th>XRefs</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<hr />
<h3 id="imports">Imports</h3>
<table>
<thead>
<tr class="header">
<th>Address</th>
<th>Import</th>
<th>XRefs</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<hr />
<h3 id="important-functions">Important Functions</h3>
<p><strong>main:</strong> undefined4 main(uint32_t arg_8h, uint32_t arg_ch)</p>
<p>This is the main function. Command line arguments are parsed here.</p>
<p><strong>GET_CONFIGURATION:</strong> undefined4 GET_CONFIGURATION(int32_t arg_8h, int32_t arg_10h, int32_t arg_18h, int32_t arg_20h)</p>
<p>This function gets the malware configuration</p>
<p><strong>callNetworkingmasters:</strong> undefined4 callNetworkingmasters<a href="int32_t%20arg_8h">28,1,large</a></p>
<p>This function checks for the commands SLEEP, UPLOAD, DOWNLOAD, CMD, or NOTHING. It then completes the action.</p>
<p><strong>UPDATE_CONFIGURATION:</strong> undefined4 UPDATE_CONFIGURATION(int32_t arg_8h, int32_t arg_ch, int32_t arg_10h, int32_t arg_14h)</p>
<p>This function updates the malware configuration via the SOFTWAREregistry key</p>
<p><strong>PAYLOAD:</strong> // WARNING: Removing unreachable block (ram,0x00402408)</p>
<p>This function contains the main malware payload</p>
<p><strong>CHECK_PASSWORD:</strong> undefined4 CHECK_PASSWORD(int32_t arg_8h)</p>
<p>This function checks if the password is correct</p>
<p><strong>INSTALL_MALWARE:</strong> undefined4 INSTALL_MALWARE(char *lpServiceName)</p>
<p>This function will install the malware</p>
<p><strong>UNINSTALL_MALWARE:</strong> undefined4 UNINSTALL_MALWARE(undefined4 lpServiceName)</p>
<p>This function will uninstall the malware</p>
<hr />
<h2 id="analysis">Analysis</h2>
<p>The program will install itself as a service if run with the -in flag. There are several command line options. The -in flag will install the malware. The -re flag will remove the malware. The -c flag will update the configuration. The -cc flag will print the configuration. This malware can be pached by changing code after the password check function to an unconditional jump. Host based indicators include the registry key and the service &quot;XYZ Manager service&quot;. This malware beacons practicalmalwareanalysis.com.</p>

</p>
					</section>

			</div>

		<!-- Footer -->
			<div id="footer">
				<ul class="joined-icons">
					<li><a href="#" class="icon fa-github"><span class="label">GitHub</span></a></li>
					<li><a href="#" class="icon fa-gitlab"><span class="label">GitLab</span></a></li>
					<li><a href="#" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
				</ul>
			</div>

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.dropotron.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/skel.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="../assets/js/main.js"></script>

	</body>
</html>
    